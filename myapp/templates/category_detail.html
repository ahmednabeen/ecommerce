{% extends 'base.html' %}

{% block title %}{{ category.name }}{% endblock %}

{% block content %}
<section class="category-products">
    <h2>{{ category.name }}</h2>

    <div class="fp-all-product-grid">
        {% for product in products %}
            <div class="fp-all-product-card">

                {% if product.is_on_sale %}
                    <span class="fp-all-product-badge fp-all-product-sale-badge">
                        Price Off
                    </span>
                {% endif %}

                <!-- 1. WRAP THE IMAGE IN A LINK -->
                <a href="{% url 'product_detail' product.id %}">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="fp-all-product-image">
                </a>

                <div class="fp-all-product-card-content">
                    <!-- 2. WRAP THE NAME IN A LINK -->
                    <h3 class="fp-all-product-name">
                        <a href="{% url 'product_detail' product.id %}">{{ product.name }}</a>
                    </h3>
                    
                    <p class="fp-all-product-price">
                        <!-- Added floatformat for consistency -->
                        à§³{{ product.price|floatformat:0 }}
                    </p>
                    
                    <button class="add-to-cart-btn" data-product-id="{{ product.id }}">
                        Add to Cart
                    </button>
                </div>
            </div>
        {% empty %}
            <p>No products in this category.</p>
        {% endfor %}
    </div>

    <!-- PAGINATION (No changes needed here) -->
    <div class="pagination">
        {% if products.has_previous %}
            <a class="page-btn" href="?page={{ products.previous_page_number }}">Previous</a>
        {% else %}
            <span class="page-btn disabled">Previous</span>
        {% endif %}
        
        <!-- ... rest of your pagination logic ... -->

        {% if products.has_next %}
            <a class="page-btn" href="?page={{ products.next_page_number }}">Next</a>
        {% else %}
            <span class="page-btn disabled">Next</span>
        {% endif %}
    </div>
</section>
{% endblock %}

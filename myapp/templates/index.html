{% extends 'base.html' %}
{% load static %}

{% block title %}Freshora - Your Online Store{% endblock %}

{% block content %}

<section class="hero">
    <div class="hero-content">
        <h1>Live Better with Freshora</h1>
        <p>Discover a supershop designed to make your life simpler, healthier, and more joyful</p>
        <a href="{% url 'product_list' %}" class="cta-button">Shop Now</a>
    </div>
</section>

<main>
    <!-- Category Section -->
    <section class="categories">
        <h2>Categories</h2>

        <div class="scroller-wrapper">
            <div class="category-track">

                <!-- FIRST SET -->
                {% for category in categories %}
                    <a href="{{ category.get_absolute_url }}" class="card-link">
                        <div class="card">
                            {% if category.image %}
                                <img src="{{ category.image.url }}"
                                    alt="{{ category.name }} logo"
                                    class="card-image">
                            {% endif %}
                            <h3 class="card-title">{{ category.name }}</h3>
                        </div>
                    </a>
                {% endfor %}

                <!-- SECOND SET (DUPLICATE FOR SEAMLESS LOOP) -->
                {% for category in categories %}
                    <a href="#" class="card-link" aria-hidden="true">
                        <div class="card">
                            {% if category.image %}
                                <img src="{{ category.image.url }}"
                                    alt=""
                                    class="card-image">
                            {% endif %}
                            <h3 class="card-title">{{ category.name }}</h3>
                        </div>
                    </a>
                {% endfor %}

            </div>
        </div>
    </section>

    <!-- Featured Product Section -->

    <section id="featured-products" class="fp-featured-products">

        <div class="fp-feat">
            <h2>Featured Products</h2>
        </div>

        <div class="fp-all-product-grid">
            {% for product in products %}
                <div class="fp-all-product-card">

                    {% if product.is_on_sale %}
                        <span class="fp-all-product-badge fp-all-product-sale-badge">
                            Price Off
                        </span>
                    {% endif %}

                    <img 
                        src="{{ product.image.url }}" 
                        alt="{{ product.name }}" 
                        class="fp-all-product-image"
                    >

                    <div class="fp-all-product-card-content">
                        {% comment %} <p class="fp-all-product-category">
                            {{ product.category.name }}
                        </p> {% endcomment %}

                        <h3 class="fp-all-product-name">
                            {{ product.name }}
                        </h3>

                        <p class="fp-all-product-price">
                            ${{ product.price }}
                        </p>

                        <button class="add-to-cart-btn"
                                data-product-id="{{ product.id }}">
                            Add to Cart
                        </button>
                    </div>

                </div>
            {% empty %}
                <p>No featured products available.</p>
            {% endfor %}
        </div>

        <!-- Pagination -->
        {% if products.paginator.num_pages > 1 %}
        <div class="fp-pagination">

            {% if products.has_previous %}
                <a href="?page={{ products.previous_page_number }}#featured-products" class="fp-page-btn">
                    Previous
                </a>
            {% else %}
                <span class="fp-page-btn disabled">Previous</span>
            {% endif %}

            {% for num in products.paginator.page_range %}
                {% if num == products.number %}
                    <span class="fp-page-number active">{{ num }}</span>
                {% else %}
                    <a href="?page={{ num }}#featured-products" class="fp-page-number">
                        {{ num }}
                    </a>
                {% endif %}
            {% endfor %}

            {% if products.has_next %}
                <a href="?page={{ products.next_page_number }}#featured-products" class="fp-page-btn">
                    Next
                </a>
            {% else %}
                <span class="fp-page-btn disabled">Next</span>
            {% endif %}

        </div>
        {% endif %}
    </section>

    <!-- Flash Products Section -->
    <section class="flash-products">
        <h2>âš¡ Flash Sale</h2>

        <div class="flash-wrapper">
            <div class="flash-track">

                <!-- FIRST SET -->
                {% for product in flash_products %}
                    <div class="fp-all-product-card flash-card">

                        <span class="fp-all-product-badge fp-all-product-sale-badge">
                            Price Off
                        </span>

                        <img 
                            src="{{ product.image.url }}" 
                            alt="{{ product.name }}" 
                            class="fp-all-product-image"
                        >

                        <div class="fp-all-product-card-content">
                            <h3 class="fp-all-product-name">
                                {{ product.name }}
                            </h3>

                            <p class="fp-all-product-price">
                                ${{ product.price }}
                            </p>

                            <button class="add-to-cart-btn"
                                    data-product-id="{{ product.id }}">
                                Add to Cart
                            </button>
                        </div>

                    </div>
                {% endfor %}

                <!-- SECOND SET (duplicate for smooth scrolling) -->
                {% for product in flash_products %}
                    <div class="fp-all-product-card flash-card" aria-hidden="true">

                        <span class="fp-all-product-badge fp-all-product-sale-badge">
                            Price Off
                        </span>

                        <img 
                            src="{{ product.image.url }}" 
                            alt="" 
                            class="fp-all-product-image"
                        >

                        <div class="fp-all-product-card-content">
                            <h3 class="fp-all-product-name">
                                {{ product.name }}
                            </h3>

                            <p class="fp-all-product-price">
                                ${{ product.price }}
                            </p>

                            <button class="add-to-cart-btn"
                                    data-product-id="{{ product.id }}">
                                Add to Cart
                            </button>
                        </div>

                    </div>
                {% endfor %}

            </div>
        </div>
    </section>

    <!-- Payment Method Section -->
    <section class="payment-methods">
        <h2>Payment Method</h2>

        <div class="payment-logos">
            <img src="{% static 'images/payoneer.webp' %}" alt="Payoneer">
            <img src="{% static 'images/American Express.png' %}" alt="American Express">
            <img src="{% static 'images/PayPal.png' %}" alt="PayPal">
            <img src="{% static 'images/visa.jpg' %}" alt="Visa">
            <img src="{% static 'images/mastercard.png' %}" alt="MasterCard">
            <img src="{% static 'images/applepay.png' %}" alt="Apple Pay">
            <img src="{% static 'images/googlepay.png' %}" alt="Google Pay">
            <img src="{% static 'images/stripe.png' %}" alt="Stripe">
        </div>
    </section>

</main>

{% endblock %}